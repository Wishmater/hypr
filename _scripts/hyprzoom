#!/usr/bin/env bash

# Hyprland cursor zoom script
# https://grok.com/c/4563f002-17b9-4e10-9a1a-f51571c888f3?rid=211ac554-00eb-44b9-8d56-ff4b6ab7a9c4

MIN_ZOOM=1.0
MAX_ZOOM=5.0
STEP=0.1

usage() {
    echo "Usage: $0 {in|out|reset|set <value>}"
    echo "Examples:"
    echo "  $0 in     # zoom in by $STEP"
    echo "  $0 out    # zoom out by $STEP"
    echo "  $0 reset  # reset to 1.0"
    echo "  $0 set 0.5"
    exit 1
}

[ $# -eq 0 ] && usage

current=$(hyprctl getoption cursor:zoom_factor | grep float | awk '{print $2}')

case "$1" in
    # in)     new=$(awk "BEGIN {print ($current + $STEP > $MAX_ZOOM ? $MAX_ZOOM : $current + $STEP)}") ;;
    # out)    new=$(awk "BEGIN {print ($current - $STEP < $MIN_ZOOM ? $MIN_ZOOM : $current - $STEP)}") ;;
    in)     new=$(awk "BEGIN {print ($current * (1+$STEP) > $MAX_ZOOM ? $MAX_ZOOM : $current * (1+$STEP))}") ;;
    out)    new=$(awk "BEGIN {print ($current / (1+$STEP) < $MIN_ZOOM ? $MIN_ZOOM : $current / (1+$STEP))}") ;;
    reset)  new=1.0 ;;
    set)    [ $# -ne 2 ] && usage
            new=$2
            new=$(awk "BEGIN {v=$new; print (v < $MIN_ZOOM ? $MIN_ZOOM : (v > $MAX_ZOOM ? $MAX_ZOOM : v))}") ;;
    *)      usage ;;
esac

echo $new

hyprctl keyword cursor:zoom_factor $new
